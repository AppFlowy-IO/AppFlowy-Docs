<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="468px" preserveAspectRatio="none" style="width:975px;height:468px;background:#FFFFFF;" version="1.1" viewBox="0 0 975 468" width="975px" zoomAndPan="magnify"><defs><filter height="300%" id="fb3f9t7u2wrr6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="118" x="422" y="17.4023">Plugin Design</text><!--MD5=[4d600dfb9cb7a7d6ad4789cb099e9fd0]
cluster Plugin-Sandbox--><polygon fill="#DDDDDD" filter="url(#fb3f9t7u2wrr6)" points="16,121.1992,137,121.1992,144,143.6875,381,143.6875,381,461.1992,16,461.1992,16,121.1992" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="16" x2="144" y1="143.6875" y2="143.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="115" x="20" y="136.7344">Plugin-Sandbox</text><!--MD5=[6dce392d352a2edeb8995b2417bcc273]
cluster Plugin-Host--><polygon fill="#DDDDDD" filter="url(#fb3f9t7u2wrr6)" points="414,27.1992,509,27.1992,516,49.6875,958,49.6875,958,344.1992,414,344.1992,414,27.1992" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="414" x2="516" y1="49.6875" y2="49.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="89" x="418" y="42.7344">Plugin-Host</text><!--MD5=[b24267d2964530fde97dbe32f532d632]
cluster frontend (Flutter)--><polygon fill="#DDDDDD" filter="url(#fb3f9t7u2wrr6)" points="438,142.1992,580,142.1992,587,164.6875,630,164.6875,630,320.1992,438,320.1992,438,142.1992" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="438" x2="587" y1="164.6875" y2="164.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="442" y="157.7344">frontend (Flutter)</text><!--MD5=[dda78dbc42a958268ede67472bfec7a7]
cluster Backend (Rust)--><polygon fill="#DDDDDD" filter="url(#fb3f9t7u2wrr6)" points="706,70.1992,828,70.1992,835,92.6875,934,92.6875,934,320.1992,706,320.1992,706,70.1992" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="706" x2="835" y1="92.6875" y2="92.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="116" x="710" y="85.7344">Backend (Rust)</text><!--MD5=[7c81bcc23c00287416d740c203a35111]
cluster plugin_module--><polygon fill="#00B5FF" filter="url(#fb3f9t7u2wrr6)" points="730,123.1992,740,113.1992,910,113.1992,910,286.1992,900,296.1992,730,296.1992,730,123.1992" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="900" x2="910" y1="123.1992" y2="113.1992"/><line style="stroke:#000000;stroke-width:1.5;" x1="730" x2="900" y1="123.1992" y2="123.1992"/><line style="stroke:#000000;stroke-width:1.5;" x1="900" x2="900" y1="123.1992" y2="296.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="104" x="764" y="139.7344">Plugin Module</text><!--MD5=[800cc48e2b989d8c928aedf62b732161]
entity plugin_api--><rect fill="#F7931E" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="109" x="243" y="156.1992"/><rect fill="#F7931E" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="332" y="161.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="330" y="163.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="330" y="167.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="258" y="189.7344">Plugin API</text><!--MD5=[5da8d761d631b44351e84bc3b7ab2412]
entity plugin_proxy--><rect fill="#F7931E" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="126" x="234.5" y="237.1992"/><rect fill="#F7931E" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="340.5" y="242.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="338.5" y="244.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="338.5" y="248.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="249.5" y="270.7344">Plugin Proxy</text><!--MD5=[e8d391ccece86cc676ba34f1ee88246b]
entity plugin_service--><rect fill="#F7931E" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="135" x="230" y="399.1992"/><rect fill="#F7931E" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="345" y="404.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="343" y="406.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="343" y="410.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="245" y="432.7344">Plugin Service</text><!--MD5=[03273a8175f826ee88358640501d48ac]
entity plugin_runner--><rect fill="#F7931E" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="137" x="32" y="399.1992"/><rect fill="#F7931E" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="149" y="404.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="147" y="406.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="147" y="410.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="47" y="432.7344">Plugin Runner</text><!--MD5=[8e6a9284dc1da0ef8b54fdd8dc5bfba7]
entity plugin--><rect fill="#F7931E" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="83" x="256" y="318.1992"/><rect fill="#F7931E" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="319" y="323.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="317" y="325.1992"/><rect fill="#F7931E" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="317" y="329.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="271" y="351.7344">Plugin</text><!--MD5=[ee844583727d087424bf344d601df539]
entity plugin_repo--><rect fill="#00B5FF" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="160" x="454" y="177.1992"/><rect fill="#00B5FF" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="594" y="182.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="592" y="184.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="592" y="188.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="469" y="210.7344">Plugin Repository</text><!--MD5=[ed21734bf4b7460cda4bd124807a15d0]
entity document--><rect fill="#00B5FF" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="153" x="457.5" y="258.1992"/><rect fill="#00B5FF" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="590.5" y="263.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="588.5" y="265.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="588.5" y="269.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="472.5" y="291.7344">Flowy Document</text><!--MD5=[17f039748855fe13244c13f0c24b81fc]
entity plugin_event--><rect fill="#00B5FF" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="124" x="757.5" y="234.1992"/><rect fill="#00B5FF" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="861.5" y="239.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="859.5" y="241.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="859.5" y="245.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="772.5" y="267.7344">Plugin Event</text><!--MD5=[ebd31c1565bf99c5e8b6bce00eb5a2d9]
entity plugin_rust_service--><rect fill="#00B5FF" filter="url(#fb3f9t7u2wrr6)" height="46.4883" style="stroke:#A80036;stroke-width:1.5;" width="135" x="752" y="153.1992"/><rect fill="#00B5FF" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="867" y="158.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="865" y="160.1992"/><rect fill="#00B5FF" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="865" y="164.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="767" y="186.7344">Plugin Service</text><!--MD5=[f8bc58f91d0e94597ff8d17b9334e620]
link plugin_runner to plugin_service--><path d="M169.15,422.1992 C187.15,422.1992 206.65,422.1992 224.86,422.1992 " fill="none" id="plugin_runner-to-plugin_service" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="229.95,422.1992,220.95,418.1992,224.95,422.1992,220.95,426.1992,229.95,422.1992" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[f0f10aa7a0b4fd8e8d8d3655fc20ea9d]
link plugin_service to plugin--><path d="M297.5,398.9492 C297.5,396.6792 297.5,395.1992 297.5,395.1992 C297.5,395.1992 297.5,378.3892 297.5,369.4492 " fill="none" id="plugin_service-to-plugin" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="297.5,364.4492,293.5,373.4492,297.5,369.4492,301.5,373.4492,297.5,364.4492" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[c418b48b73ac51aacaaf7e8b9fa8bfa2]
link plugin to plugin_proxy--><path d="M297.5,317.9492 C297.5,315.6792 297.5,314.1992 297.5,314.1992 C297.5,314.1992 297.5,297.3892 297.5,288.4492 " fill="none" id="plugin-to-plugin_proxy" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="297.5,283.4492,293.5,292.4492,297.5,288.4492,301.5,292.4492,297.5,283.4492" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[6d91dd6f72027cf78278c1049867bc27]
link plugin_proxy to plugin_api--><path d="M297.5,236.9492 C297.5,234.6792 297.5,233.1992 297.5,233.1992 C297.5,233.1992 297.5,216.3892 297.5,207.4492 " fill="none" id="plugin_proxy-to-plugin_api" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="297.5,202.4492,293.5,211.4492,297.5,207.4492,301.5,211.4492,297.5,202.4492" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[3f861fb54d1e775a16c1f84b9ef6687d]
link plugin_api to plugin_repo--><path d="M352.01,183.9892 C380.62,186.5492 416.51,189.7692 448.77,192.6592 " fill="none" id="plugin_api-to-plugin_repo" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="453.91,193.1192,445.3004,188.3364,448.9297,192.6756,444.5906,196.3049,453.91,193.1192" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a4b58d9aa29db6add1e5a5fcd72c7a20]
link plugin_repo to plugin_event--><path d="M614.35,216.1492 C657.79,224.8892 711.01,235.5892 752.21,243.8692 " fill="none" id="plugin_repo-to-plugin_event" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="757.18,244.8692,749.1456,239.1728,752.2782,243.8831,747.5679,247.0157,757.18,244.8692" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="647" y="220.7676">FFI</text><!--MD5=[33b00ea68d31ce24de7e90e1040765ce]
link plugin_event to plugin_rust_service--><path d="M819.5,233.9492 C819.5,231.6792 819.5,230.1992 819.5,230.1992 C819.5,230.1992 819.5,213.3892 819.5,204.4492 " fill="none" id="plugin_event-to-plugin_rust_service" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="819.5,199.4492,815.5,208.4492,819.5,204.4492,823.5,208.4492,819.5,199.4492" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[448d64ad28232aee3bd74e3d29ddf30b]
link plugin to document--><path d="M339.08,330.8192 C368.16,323.3792 408.45,313.0692 444.77,303.7792 " fill="none" id="plugin-to-document" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="457.43,300.5392,450.6249,298.1537,445.8055,303.5178,452.6106,305.9033,457.43,300.5392" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[57c0d3cacbf1784fbb7e064f750e039d]
@startuml AppFlowy
title Plugin Design
left to right direction
skinparam linetype polyline

package "Plugin-Sandbox"  #DDDDDD {
    component [Plugin API] as plugin_api #F7931E
    component [Plugin Proxy] as plugin_proxy #F7931E
    component [Plugin Service] as plugin_service #F7931E
    component [Plugin Runner] as plugin_runner #F7931E
    component [Plugin] as plugin #F7931E
}

package Plugin-Host #DDDDDD {
    package "frontend (Flutter)" {
        component [Plugin Repository] as plugin_repo #00B5FF
        component [Flowy Document] as document #00B5FF
    }

    package "Backend (Rust)" {
        node "Plugin Module" as plugin_module #00B5FF {
            component [Plugin Event] as plugin_event #00B5FF
            component [Plugin Service] as plugin_rust_service #00B5FF
        }
    }
}

plugin_runner ..> plugin_service
plugin_service .> plugin
plugin .> plugin_proxy
plugin_proxy .> plugin_api
plugin_api ..> plugin_repo
plugin_repo ..> plugin_event : FFI
plugin_event .> plugin_rust_service


plugin - -o document
@enduml

PlantUML version 1.2022.0(Wed Jan 12 00:16:42 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>